{"version":3,"file":"core.js","sources":["../lib/common/utils.js","../lib/common/options.js","../lib/core/module.js","../lib/core/meta.js","../lib/core/renderer.js","../lib/core/nuxt.js"],"sourcesContent":["import { resolve, relative, sep } from 'path'\nimport _ from 'lodash'\n\nexport function encodeHtml(str) {\n  return str.replace(/</g, '&lt;').replace(/>/g, '&gt;')\n}\n\nexport function getContext(req, res) {\n  return { req, res }\n}\n\nexport function setAnsiColors(ansiHTML) {\n  ansiHTML.setColors({\n    reset: ['efefef', 'a6004c'],\n    darkgrey: '5a012b',\n    yellow: 'ffab07',\n    green: 'aeefba',\n    magenta: 'ff84bf',\n    blue: '3505a0',\n    cyan: '56eaec',\n    red: '4e053a'\n  })\n}\n\nexport async function waitFor(ms) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, (ms || 0))\n  })\n}\n\nexport function urlJoin() {\n  return [].slice.call(arguments).join('/').replace(/\\/+/g, '/').replace(':/', '://')\n}\n\nexport function isUrl(url) {\n  return (url.indexOf('http') === 0 || url.indexOf('//') === 0)\n}\n\nexport function promisifyRoute(fn) {\n  // If routes is an array\n  if (Array.isArray(fn)) {\n    return Promise.resolve(fn)\n  }\n  // If routes is a function expecting a callback\n  if (fn.length === 1) {\n    return new Promise((resolve, reject) => {\n      fn(function (err, routeParams) {\n        if (err) {\n          reject(err)\n        }\n        resolve(routeParams)\n      })\n    })\n  }\n  let promise = fn()\n  if (!promise || (!(promise instanceof Promise) && (typeof promise.then !== 'function'))) {\n    promise = Promise.resolve(promise)\n  }\n  return promise\n}\n\nexport function sequence(tasks, fn) {\n  return tasks.reduce((promise, task) => promise.then(() => fn(task)), Promise.resolve())\n}\n\nexport function parallel(tasks, fn) {\n  return Promise.all(tasks.map(task => fn(task)))\n}\n\nexport function chainFn(base, fn) {\n  /* istanbul ignore if */\n  if (!(fn instanceof Function)) {\n    return\n  }\n  return function () {\n    if (typeof base !== 'function') {\n      return fn.apply(this, arguments)\n    }\n    let baseResult = base.apply(this, arguments)\n    // Allow function to mutate the first argument instead of returning the result\n    if (baseResult === undefined) {\n      baseResult = arguments[0]\n    }\n    let fnResult = fn.call(this, baseResult, ...Array.prototype.slice.call(arguments, 1))\n    // Return mutated argument if no result was returned\n    if (fnResult === undefined) {\n      return baseResult\n    }\n    return fnResult\n  }\n}\n\nexport function isPureObject(o) {\n  return !Array.isArray(o) && typeof o === 'object'\n}\n\nexport const isWindows = /^win/.test(process.platform)\n\nexport function wp(p = '') {\n  /* istanbul ignore if */\n  if (isWindows) {\n    return p.replace(/\\\\/g, '\\\\\\\\')\n  }\n  return p\n}\n\nexport function wChunk(p = '') {\n  /* istanbul ignore if */\n  if (isWindows) {\n    return p.replace(/\\//g, '\\\\\\\\')\n  }\n  return p\n}\n\nconst reqSep = /\\//g\nconst sysSep = _.escapeRegExp(sep)\nconst normalize = string => string.replace(reqSep, sysSep)\n\nexport function r() {\n  let args = Array.prototype.slice.apply(arguments)\n  let lastArg = _.last(args)\n\n  if (lastArg.includes('@') || lastArg.includes('~')) {\n    return wp(lastArg)\n  }\n\n  return wp(resolve(...args.map(normalize)))\n}\n\nexport function relativeTo() {\n  let args = Array.prototype.slice.apply(arguments)\n  let dir = args.shift()\n\n  // Resolve path\n  let path = r(...args)\n\n  // Check if path is an alias\n  if (path.includes('@') || path.includes('~')) {\n    return path\n  }\n\n  // Make correct relative path\n  let rp = relative(dir, path)\n  if (rp[0] !== '.') {\n    rp = './' + rp\n  }\n  return wp(rp)\n}\n\nexport function flatRoutes(router, path = '', routes = []) {\n  router.forEach((r) => {\n    if (!r.path.includes(':') && !r.path.includes('*')) {\n      /* istanbul ignore if */\n      if (r.children) {\n        flatRoutes(r.children, path + r.path + '/', routes)\n      } else {\n        routes.push((r.path === '' && path[path.length - 1] === '/' ? path.slice(0, -1) : path) + r.path)\n      }\n    }\n  })\n  return routes\n}\n\nexport function cleanChildrenRoutes(routes, isChild = false) {\n  let start = -1\n  let routesIndex = []\n  routes.forEach((route) => {\n    if (/-index$/.test(route.name) || route.name === 'index') {\n      // Save indexOf 'index' key in name\n      let res = route.name.split('-')\n      let s = res.indexOf('index')\n      start = (start === -1 || s < start) ? s : start\n      routesIndex.push(res)\n    }\n  })\n  routes.forEach((route) => {\n    route.path = (isChild) ? route.path.replace('/', '') : route.path\n    if (route.path.indexOf('?') > -1) {\n      let names = route.name.split('-')\n      let paths = route.path.split('/')\n      if (!isChild) {\n        paths.shift()\n      } // clean first / for parents\n      routesIndex.forEach((r) => {\n        let i = r.indexOf('index') - start //  children names\n        if (i < paths.length) {\n          for (let a = 0; a <= i; a++) {\n            if (a === i) {\n              paths[a] = paths[a].replace('?', '')\n            }\n            if (a < i && names[a] !== r[a]) {\n              break\n            }\n          }\n        }\n      })\n      route.path = (isChild ? '' : '/') + paths.join('/')\n    }\n    route.name = route.name.replace(/-index$/, '')\n    if (route.children) {\n      if (route.children.find((child) => child.path === '')) {\n        delete route.name\n      }\n      route.children = cleanChildrenRoutes(route.children, true)\n    }\n  })\n  return routes\n}\n\nexport function createRoutes(files, srcDir) {\n  let routes = []\n  files.forEach((file) => {\n    let keys = file.replace(/^pages/, '').replace(/\\.vue$/, '').replace(/\\/{2,}/g, '/').split('/').slice(1)\n    let route = { name: '', path: '', component: r(srcDir, file) }\n    let parent = routes\n    keys.forEach((key, i) => {\n      route.name = route.name ? route.name + '-' + key.replace('_', '') : key.replace('_', '')\n      route.name += (key === '_') ? 'all' : ''\n      route.chunkName = file.replace(/\\.vue$/, '')\n      let child = _.find(parent, { name: route.name })\n      if (child) {\n        child.children = child.children || []\n        parent = child.children\n        route.path = ''\n      } else {\n        if (key === 'index' && (i + 1) === keys.length) {\n          route.path += (i > 0 ? '' : '/')\n        } else {\n          route.path += '/' + (key === '_' ? '*' : key.replace('_', ':'))\n          if (key !== '_' && key.indexOf('_') !== -1) {\n            route.path += '?'\n          }\n        }\n      }\n    })\n    // Order Routes path\n    parent.push(route)\n    parent.sort((a, b) => {\n      if (!a.path.length || a.path === '/') {\n        return -1\n      }\n      if (!b.path.length || b.path === '/') {\n        return 1\n      }\n      let i = 0\n      let res = 0\n      let y = 0\n      let z = 0\n      const _a = a.path.split('/')\n      const _b = b.path.split('/')\n      for (i = 0; i < _a.length; i++) {\n        if (res !== 0) {\n          break\n        }\n        y = _a[i] === '*' ? 2 : (_a[i].indexOf(':') > -1 ? 1 : 0)\n        z = _b[i] === '*' ? 2 : (_b[i].indexOf(':') > -1 ? 1 : 0)\n        res = y - z\n        // If a.length >= b.length\n        if (i === _b.length - 1 && res === 0) {\n          // change order if * found\n          res = _a[i] === '*' ? -1 : 1\n        }\n      }\n      return res === 0 ? (_a[i - 1] === '*' && _b[i] ? 1 : -1) : res\n    })\n  })\n  return cleanChildrenRoutes(routes)\n}\n","import _ from 'lodash'\nimport Debug from 'debug'\nimport { join, resolve } from 'path'\nimport { existsSync } from 'fs'\nimport { isUrl, isPureObject } from 'utils'\n\nconst debug = Debug('nuxt:build')\ndebug.color = 2 // Force green color\n\nconst Options = {}\n\nexport default Options\n\nOptions.from = function (_options) {\n  // Clone options to prevent unwanted side-effects\n  const options = Object.assign({}, _options)\n\n  // Normalize options\n  if (options.loading === true) {\n    delete options.loading\n  }\n  if (options.router && options.router.middleware && !Array.isArray(options.router.middleware)) {\n    options.router.middleware = [options.router.middleware]\n  }\n  if (options.router && typeof options.router.base === 'string') {\n    options._routerBaseSpecified = true\n  }\n  if (typeof options.transition === 'string') {\n    options.transition = { name: options.transition }\n  }\n  if (typeof options.layoutTransition === 'string') {\n    options.layoutTransition = { name: options.layoutTransition }\n  }\n\n  // Apply defaults\n  _.defaultsDeep(options, Options.defaults)\n\n  // Resolve dirs\n  const hasValue = v => typeof v === 'string' && v\n  options.rootDir = hasValue(options.rootDir) ? options.rootDir : process.cwd()\n  options.srcDir = hasValue(options.srcDir) ? resolve(options.rootDir, options.srcDir) : options.rootDir\n  options.modulesDir = resolve(options.rootDir, hasValue(options.modulesDir) ? options.modulesDir : 'node_modules')\n  options.buildDir = resolve(options.rootDir, options.buildDir)\n  options.cacheDir = resolve(options.rootDir, options.cacheDir)\n\n  // If app.html is defined, set the template path to the user template\n  options.appTemplatePath = resolve(options.buildDir, 'views/app.template.html')\n  if (existsSync(join(options.srcDir, 'app.html'))) {\n    options.appTemplatePath = join(options.srcDir, 'app.html')\n  }\n\n  // Ignore publicPath on dev\n  /* istanbul ignore if */\n  if (options.dev && isUrl(options.build.publicPath)) {\n    options.build.publicPath = Options.defaults.build.publicPath\n  }\n\n  // If store defined, update store options to true unless explicitly disabled\n  if (options.store !== false && existsSync(join(options.srcDir, 'store'))) {\n    options.store = true\n  }\n\n  // Normalize loadingIndicator\n  if (!isPureObject(options.loadingIndicator)) {\n    options.loadingIndicator = { name: options.loadingIndicator }\n  }\n\n  // Apply defaults to loadingIndicator\n  options.loadingIndicator = Object.assign({\n    name: 'pulse',\n    color: '#dbe1ec',\n    background: 'white'\n  }, options.loadingIndicator)\n\n  // cssSourceMap\n  if (options.build.cssSourceMap === undefined) {\n    options.build.cssSourceMap = options.dev\n  }\n\n  // Postcss\n  // 1. Check if it is explicitly disabled by false value\n  // ... Disable all postcss loaders\n  // 2. Check if any standard source of postcss config exists\n  // ... Make postcss = { config: { path } }\n  // 3. Else (Easy Usage)\n  // ... Auto merge it with defaults\n  if (options.build.postcss !== false) {\n    // Detect postcss config existence\n    // https://github.com/michael-ciniawsky/postcss-load-config\n    let postcssConfigPath\n    for (let dir of [options.srcDir, options.rootDir]) {\n      for (let file of ['postcss.config.js', '.postcssrc.js', '.postcssrc', '.postcssrc.json', '.postcssrc.yaml']) {\n        if (existsSync(resolve(dir, file))) {\n          postcssConfigPath = resolve(dir, file)\n          break\n        }\n      }\n      if (postcssConfigPath) break\n    }\n\n    // Default postcss options\n    if (postcssConfigPath) {\n      debug(`Using PostCSS config file: ${postcssConfigPath}`)\n      options.build.postcss = {\n        sourceMap: options.build.cssSourceMap,\n        // https://github.com/postcss/postcss-loader/blob/master/lib/index.js#L79\n        config: {\n          path: postcssConfigPath\n        }\n      }\n    } else {\n      if (Object.keys(options.build.postcss).length) {\n        debug('Using PostCSS config from `build.postcss`')\n      }\n      // Normalize & Apply default plugins\n      if (Array.isArray(options.build.postcss)) {\n        options.build.postcss = { plugins: options.build.postcss }\n      }\n      if (isPureObject(options.build.postcss)) {\n        options.build.postcss = Object.assign({\n          sourceMap: options.build.cssSourceMap,\n          plugins: {\n            // https://github.com/postcss/postcss-import\n            'postcss-import': {\n              root: options.rootDir,\n              path: [\n                options.srcDir,\n                options.rootDir,\n                options.modulesDir\n              ]\n            },\n            // https://github.com/postcss/postcss-url\n            'postcss-url': {},\n            // http://cssnext.io/postcss\n            'postcss-cssnext': {}\n          }\n        }, options.build.postcss)\n      }\n    }\n  }\n\n  // Debug errors\n  if (options.debug === undefined) {\n    options.debug = options.dev\n  }\n\n  // Apply mode preset\n  let modePreset = Options.modes[options.mode || 'universal'] || Options.modes['universal']\n  _.defaultsDeep(options, modePreset)\n\n  // If no server-side rendering, add appear true transition\n  if (options.render.ssr === false) {\n    options.transition.appear = true\n  }\n\n  return options\n}\n\nOptions.modes = {\n  universal: {\n    build: {\n      ssr: true\n    },\n    render: {\n      ssr: true\n    }\n  },\n  spa: {\n    build: {\n      ssr: false\n    },\n    render: {\n      ssr: false\n    }\n  }\n}\n\nOptions.defaults = {\n  mode: 'universal',\n  dev: process.env.NODE_ENV !== 'production',\n  debug: undefined, // Will be equal to dev if not provided\n  buildDir: '.nuxt',\n  cacheDir: '.cache',\n  nuxtAppDir: resolve(__dirname, '../lib/app/'), // Relative to dist\n  build: {\n    analyze: false,\n    dll: false,\n    scopeHoisting: false,\n    extractCSS: false,\n    cssSourceMap: undefined,\n    ssr: undefined,\n    publicPath: '/_nuxt/',\n    filenames: {\n      css: 'vendor.[contenthash].css',\n      manifest: 'manifest.[hash].js',\n      vendor: 'vendor.[chunkhash].js',\n      app: 'app.[chunkhash].js',\n      chunk: '[name].[chunkhash].js'\n    },\n    vendor: [],\n    plugins: [],\n    babel: {},\n    postcss: {},\n    templates: [],\n    watch: [],\n    devMiddleware: {},\n    hotMiddleware: {}\n  },\n  generate: {\n    dir: 'dist',\n    routes: [],\n    concurrency: 500,\n    interval: 0,\n    minify: {\n      collapseBooleanAttributes: true,\n      collapseWhitespace: false,\n      decodeEntities: true,\n      minifyCSS: true,\n      minifyJS: true,\n      processConditionalComments: true,\n      removeAttributeQuotes: false,\n      removeComments: false,\n      removeEmptyAttributes: true,\n      removeOptionalTags: true,\n      removeRedundantAttributes: true,\n      removeScriptTypeAttributes: false,\n      removeStyleLinkTypeAttributes: false,\n      removeTagWhitespace: false,\n      sortAttributes: true,\n      sortClassName: false,\n      trimCustomFragments: true,\n      useShortDoctype: true\n    }\n  },\n  env: {},\n  head: {\n    meta: [],\n    link: [],\n    style: [],\n    script: []\n  },\n  plugins: [],\n  css: [],\n  modules: [],\n  layouts: {},\n  serverMiddleware: [],\n  ErrorPage: null,\n  loading: {\n    color: 'black',\n    failedColor: 'red',\n    height: '2px',\n    duration: 5000,\n    rtl: false\n  },\n  loadingIndicator: {},\n  transition: {\n    name: 'page',\n    mode: 'out-in',\n    appear: false,\n    appearClass: 'appear',\n    appearActiveClass: 'appear-active',\n    appearToClass: 'appear-to'\n  },\n  layoutTransition: {\n    name: 'layout',\n    mode: 'out-in'\n  },\n  router: {\n    mode: 'history',\n    base: '/',\n    routes: [],\n    middleware: [],\n    linkActiveClass: 'nuxt-link-active',\n    linkExactActiveClass: 'nuxt-link-exact-active',\n    extendRoutes: null,\n    scrollBehavior: null,\n    parseQuery: false,\n    stringifyQuery: false,\n    fallback: false\n  },\n  render: {\n    bundleRenderer: {},\n    resourceHints: true,\n    ssr: undefined,\n    http2: {\n      push: false\n    },\n    static: {},\n    gzip: {\n      threshold: 0\n    },\n    etag: {\n      weak: true // Faster for responses > 5KB\n    }\n  },\n  watchers: {\n    webpack: {\n      ignored: /-dll/\n    },\n    chokidar: {}\n  },\n  editor: {\n    editor: 'code'\n  },\n  hooks: null,\n  messages: {\n    error_404: 'This page could not be found',\n    server_error: 'Server error',\n    nuxtjs: 'Nuxt.js',\n    back_to_home: 'Back to the home page',\n    server_error_details: 'An error occurred in the application and your page could not be served. If you are the application owner, check your logs for details.',\n    client_error: 'Error',\n    client_error_details: 'An error occurred while rendering the page. Check developer tools console for details.'\n  }\n}\n","import path from 'path'\nimport fs from 'fs'\nimport { uniq } from 'lodash'\nimport hash from 'hash-sum'\nimport { chainFn, sequence } from 'utils'\nimport Debug from 'debug'\n\nconst debug = Debug('nuxt:module')\n\nexport default class ModuleContainer {\n  constructor(nuxt) {\n    this.nuxt = nuxt\n    this.options = nuxt.options\n    this.requiredModules = []\n  }\n\n  async ready() {\n    await this.nuxt.callHook('modules:before', this, this.options.modules)\n    // Load every module in sequence\n    await sequence(this.options.modules, this.addModule.bind(this))\n    // Call done hook\n    await this.nuxt.callHook('modules:done', this)\n  }\n\n  addVendor(vendor) {\n    /* istanbul ignore if */\n    if (!vendor) {\n      return\n    }\n    this.options.build.vendor = uniq(this.options.build.vendor.concat(vendor))\n  }\n\n  addTemplate(template) {\n    /* istanbul ignore if */\n    if (!template) {\n      return\n    }\n    // Validate & parse source\n    const src = template.src || template\n    const srcPath = path.parse(src)\n    /* istanbul ignore if */\n    if (!src || typeof src !== 'string' || !fs.existsSync(src)) {\n      /* istanbul ignore next */\n      debug('[nuxt] invalid template', template)\n      return\n    }\n    // Generate unique and human readable dst filename\n    const dst = template.fileName ||\n      (path.basename(srcPath.dir) + '.' + srcPath.name + '.' + hash(src) + srcPath.ext)\n    // Add to templates list\n    const templateObj = {\n      src,\n      dst,\n      options: template.options\n    }\n    this.options.build.templates.push(templateObj)\n    return templateObj\n  }\n\n  addPlugin(template) {\n    const { dst } = this.addTemplate(template)\n    // Add to nuxt plugins\n    this.options.plugins.unshift({\n      src: path.join(this.options.buildDir, dst),\n      ssr: template.ssr\n    })\n  }\n\n  addServerMiddleware(middleware) {\n    this.options.serverMiddleware.push(middleware)\n  }\n\n  extendBuild(fn) {\n    this.options.build.extend = chainFn(this.options.build.extend, fn)\n  }\n\n  extendRoutes(fn) {\n    this.options.router.extendRoutes = chainFn(this.options.router.extendRoutes, fn)\n  }\n\n  requireModule(moduleOpts) {\n    // Require once\n    return this.addModule(moduleOpts, true)\n  }\n\n  async addModule(moduleOpts, requireOnce) {\n    /* istanbul ignore if */\n    if (!moduleOpts) {\n      return\n    }\n\n    // Allow using babel style array options\n    if (Array.isArray(moduleOpts)) {\n      moduleOpts = {\n        src: moduleOpts[0],\n        options: moduleOpts[1]\n      }\n    }\n\n    // Allows passing runtime options to each module\n    const options = moduleOpts.options || (typeof moduleOpts === 'object' ? moduleOpts : {})\n    const src = moduleOpts.src || moduleOpts\n\n    // Resolve module\n    let module\n    if (typeof src === 'string') {\n      module = require(this.nuxt.resolvePath(src))\n    }\n\n    // Validate module\n    /* istanbul ignore if */\n    if (typeof module !== 'function') {\n      throw new Error(`[nuxt] Module ${JSON.stringify(src)} should export a function`)\n    }\n\n    // Module meta\n    module.meta = module.meta || {}\n    let name = module.meta.name || module.name\n\n    // If requireOnce specified & module from NPM or with specified name\n    if (requireOnce && name) {\n      const alreadyRequired = this.requiredModules.indexOf(name) !== -1\n      if (requireOnce && alreadyRequired) {\n        return\n      }\n      if (!alreadyRequired) {\n        this.requiredModules.push(name)\n      }\n    }\n\n    // Call module with `this` context and pass options\n    await new Promise((resolve, reject) => {\n      const result = module.call(this, options, (err) => {\n        /* istanbul ignore if */\n        if (err) {\n          return reject(err)\n        }\n        resolve()\n      })\n      // If module send back a promise\n      if (result && result.then instanceof Function) {\n        return result.then(resolve)\n      }\n      // If not expecting a callback but returns no promise (=synchronous)\n      if (module.length < 2) {\n        return resolve()\n      }\n    })\n  }\n}\n","\nimport Vue from 'vue'\nimport VueMeta from 'vue-meta'\nimport VueServerRenderer from 'vue-server-renderer'\nimport LRU from 'lru-cache'\n\nexport default class MetaRenderer {\n  constructor(nuxt, renderer) {\n    this.nuxt = nuxt\n    this.renderer = renderer\n    this.options = nuxt.options\n    this.vueRenderer = VueServerRenderer.createRenderer()\n    this.cache = LRU({})\n\n    // Add VueMeta to Vue (this is only for SPA mode)\n    // See lib/app/index.js\n    Vue.use(VueMeta, {\n      keyName: 'head',\n      attribute: 'data-n-head',\n      ssrAttribute: 'data-n-head-ssr',\n      tagIDKeyName: 'hid'\n    })\n  }\n\n  getMeta(url) {\n    return new Promise((resolve, reject) => {\n      const vm = new Vue({\n        render: (h) => h(), // Render empty html tag\n        head: this.options.head || {}\n      })\n      this.vueRenderer.renderToString(vm, (err) => {\n        if (err) return reject(err)\n        resolve(vm.$meta().inject())\n      })\n    })\n  }\n\n  async render({ url = '/' }) {\n    let meta = this.cache.get(url)\n\n    if (meta) {\n      return meta\n    }\n\n    meta = {\n      HTML_ATTRS: '',\n      BODY_ATTRS: '',\n      HEAD: '',\n      BODY_SCRIPTS: ''\n    }\n    // Get vue-meta context\n    const m = await this.getMeta(url)\n    // HTML_ATTRS\n    meta.HTML_ATTRS = m.htmlAttrs.text()\n    // BODY_ATTRS\n    meta.BODY_ATTRS = m.bodyAttrs.text()\n    // HEAD tags\n    meta.HEAD = m.meta.text() + m.title.text() + m.link.text() + m.style.text() + m.script.text() + m.noscript.text()\n    // BODY_SCRIPTS\n    meta.BODY_SCRIPTS = m.script.text({ body: true })\n    // Resources Hints\n    meta.resourceHints = ''\n    // Resource Hints\n    const clientManifest = this.renderer.resources.clientManifest\n    if (this.options.render.resourceHints && clientManifest) {\n      const publicPath = clientManifest.publicPath || '/_nuxt/'\n      // Pre-Load initial resources\n      if (Array.isArray(clientManifest.initial)) {\n        meta.resourceHints += clientManifest.initial.map(r => `<link rel=\"preload\" href=\"${publicPath}${r}\" as=\"script\" />`).join('')\n      }\n      // Pre-Fetch async resources\n      if (Array.isArray(clientManifest.async)) {\n        meta.resourceHints += clientManifest.async.map(r => `<link rel=\"prefetch\" href=\"${publicPath}${r}\" />`).join('')\n      }\n      // Add them to HEAD\n      if (meta.resourceHints) {\n        meta.HEAD += meta.resourceHints\n      }\n    }\n\n    // Set meta tags inside cache\n    this.cache.set(url, meta)\n\n    return meta\n  }\n}\n","import ansiHTML from 'ansi-html'\nimport serialize from 'serialize-javascript'\nimport generateETag from 'etag'\nimport fresh from 'fresh'\nimport serveStatic from 'serve-static'\nimport compression from 'compression'\nimport _ from 'lodash'\nimport { join, resolve } from 'path'\nimport fs from 'fs-extra'\nimport { createBundleRenderer } from 'vue-server-renderer'\nimport { getContext, setAnsiColors, isUrl } from 'utils'\nimport Debug from 'debug'\nimport Youch from '@nuxtjs/youch'\nimport { SourceMapConsumer } from 'source-map'\nimport connect from 'connect'\nimport { Options } from 'common'\nimport MetaRenderer from './meta'\n\nconst debug = Debug('nuxt:render')\ndebug.color = 4 // Force blue color\n\nsetAnsiColors(ansiHTML)\n\nlet jsdom = null\n\nexport default class Renderer {\n  constructor(nuxt) {\n    this.nuxt = nuxt\n    this.options = nuxt.options\n\n    // Will be set by createRenderer\n    this.bundleRenderer = null\n    this.metaRenderer = null\n\n    // Will be available on dev\n    this.webpackDevMiddleware = null\n    this.webpackHotMiddleware = null\n\n    // Create new connect instance\n    this.app = connect()\n\n    // Renderer runtime resources\n    this.resources = {\n      clientManifest: null,\n      serverBundle: null,\n      ssrTemplate: null,\n      spaTemplate: null,\n      errorTemplate: parseTemplate('Nuxt.js Internal Server Error')\n    }\n  }\n\n  async ready() {\n    await this.nuxt.callHook('render:before', this, this.options.render)\n    // Setup nuxt middleware\n    await this.setupMiddleware()\n\n    // Production: Load SSR resources from fs\n    if (!this.options.dev) {\n      await this.loadResources()\n    }\n\n    // Call done hook\n    await this.nuxt.callHook('render:done', this)\n  }\n\n  async loadResources(_fs = fs) {\n    let distPath = resolve(this.options.buildDir, 'dist')\n    let updated = []\n\n    resourceMap.forEach(({ key, fileName, transform }) => {\n      let rawKey = '$$' + key\n      const path = join(distPath, fileName)\n\n      let rawData, data\n      if (!_fs.existsSync(path)) {\n        return // Resource not exists\n      }\n      rawData = _fs.readFileSync(path, 'utf8')\n      if (!rawData || rawData === this.resources[rawKey]) {\n        return // No changes\n      }\n      this.resources[rawKey] = rawData\n      data = transform(rawData)\n      /* istanbul ignore if */\n      if (!data) {\n        return // Invalid data ?\n      }\n      this.resources[key] = data\n      updated.push(key)\n    })\n\n    // Reload error template\n    const errorTemplatePath = resolve(this.options.buildDir, 'views/error.html')\n    if (fs.existsSync(errorTemplatePath)) {\n      this.resources.errorTemplate = parseTemplate(fs.readFileSync(errorTemplatePath, 'utf8'))\n    }\n\n    // Load loading template\n    const loadingHTMLPath = resolve(this.options.buildDir, 'loading.html')\n    if (fs.existsSync(loadingHTMLPath)) {\n      this.resources.loadingHTML = fs.readFileSync(loadingHTMLPath, 'utf8')\n      this.resources.loadingHTML = this.resources.loadingHTML.replace(/[\\r|\\n]/g, '')\n    } else {\n      this.resources.loadingHTML = ''\n    }\n\n    // Call resourcesLoaded plugin\n    await this.nuxt.callHook('render:resourcesLoaded', this.resources)\n\n    if (updated.length > 0) {\n      this.createRenderer()\n    }\n  }\n\n  get noSSR() {\n    return this.options.render.ssr === false\n  }\n\n  get isReady() {\n    if (this.noSSR) {\n      return Boolean(this.resources.spaTemplate)\n    }\n\n    return Boolean(this.bundleRenderer && this.resources.ssrTemplate)\n  }\n\n  get isResourcesAvailable() {\n    // Required for both\n    if (!this.resources.clientManifest) {\n      return false\n    }\n\n    // Required for SPA rendering\n    if (this.noSSR) {\n      return Boolean(this.resources.spaTemplate)\n    }\n\n    // Required for bundle renderer\n    return Boolean(this.resources.ssrTemplate && this.resources.serverBundle)\n  }\n\n  createRenderer() {\n    // Ensure resources are available\n    if (!this.isResourcesAvailable) {\n      return\n    }\n\n    // Create Meta Renderer\n    this.metaRenderer = new MetaRenderer(this.nuxt, this)\n\n    // Skip following steps if noSSR mode\n    if (this.noSSR) {\n      return\n    }\n\n    // Create bundle renderer for SSR\n    this.bundleRenderer = createBundleRenderer(this.resources.serverBundle, Object.assign({\n      clientManifest: this.resources.clientManifest,\n      runInNewContext: false,\n      basedir: this.options.rootDir\n    }, this.options.render.bundleRenderer))\n  }\n\n  useMiddleware(m) {\n    // Resolve\n    const $m = m\n    let src\n    if (typeof m === 'string') {\n      src = this.nuxt.resolvePath(m)\n      m = require(src)\n    }\n    if (typeof m.handler === 'string') {\n      src = this.nuxt.resolvePath(m.handler)\n      m.handler = require(src)\n    }\n\n    const handler = m.handler || m\n    const path = (((m.prefix !== false) ? this.options.router.base : '') + (typeof m.path === 'string' ? m.path : '')).replace(/\\/\\//g, '/')\n\n    // Inject $src and $m to final handler\n    if (src) handler.$src = src\n    handler.$m = $m\n\n    // Use middleware\n    this.app.use(path, handler)\n  }\n\n  get publicPath() {\n    return isUrl(this.options.build.publicPath) ? Options.defaults.build.publicPath : this.options.build.publicPath\n  }\n\n  async setupMiddleware() {\n    // Apply setupMiddleware from modules first\n    await this.nuxt.callHook('render:setupMiddleware', this.app)\n\n    // Gzip middleware for production\n    if (!this.options.dev && this.options.render.gzip) {\n      this.useMiddleware(compression(this.options.render.gzip))\n    }\n\n    // Common URL checks\n    this.useMiddleware((req, res, next) => {\n      // Prevent access to SSR resources\n      if (ssrResourceRegex.test(req.url)) {\n        res.statusCode = 404\n        return res.end()\n      }\n      next()\n    })\n\n    // Add webpack middleware only for development\n    if (this.options.dev) {\n      this.useMiddleware(async (req, res, next) => {\n        if (this.webpackDevMiddleware) {\n          await this.webpackDevMiddleware(req, res)\n        }\n        if (this.webpackHotMiddleware) {\n          await this.webpackHotMiddleware(req, res)\n        }\n        next()\n      })\n    }\n\n    // open in editor for debug mode only\n    const _this = this\n    if (this.options.debug) {\n      this.useMiddleware({\n        path: '_open',\n        handler(req, res) {\n          // Lazy load open-in-editor\n          const openInEditor = require('open-in-editor')\n          const editor = openInEditor.configure(_this.options.editor)\n          // Parse Query\n          const query = req.url.split('?')[1].split('&').reduce((q, part) => {\n            const s = part.split('=')\n            q[s[0]] = decodeURIComponent(s[1])\n            return q\n          }, {})\n          // eslint-disable-next-line no-console\n          console.log('[open in editor]', query.file)\n          editor.open(query.file).then(() => {\n            res.end('opened in editor!')\n          }).catch(err => {\n            res.end(err)\n          })\n        }\n      })\n    }\n\n    // For serving static/ files to /\n    this.useMiddleware(serveStatic(resolve(this.options.srcDir, 'static'), this.options.render.static))\n\n    // Serve .nuxt/dist/ files only for production\n    // For dev they will be served with devMiddleware\n    if (!this.options.dev) {\n      const distDir = resolve(this.options.buildDir, 'dist')\n      this.useMiddleware({\n        path: this.publicPath,\n        handler: serveStatic(distDir, {\n          index: false, // Don't serve index.html template\n          maxAge: '1y' // 1 year in production\n        })\n      })\n    }\n\n    // Add User provided middleware\n    this.options.serverMiddleware.forEach(m => {\n      this.useMiddleware(m)\n    })\n\n    // Finally use nuxtMiddleware\n    this.useMiddleware(this.nuxtMiddleware.bind(this))\n\n    // Error middleware for errors that occurred in middleware that declared above\n    // Middleware should exactly take 4 arguments\n    // https://github.com/senchalabs/connect#error-middleware\n    this.useMiddleware(this.errorMiddleware.bind(this))\n  }\n\n  async nuxtMiddleware(req, res, next) {\n    // Get context\n    const context = getContext(req, res)\n\n    res.statusCode = 200\n    try {\n      const result = await this.renderRoute(req.url, context)\n      await this.nuxt.callHook('render:route', req.url, result)\n      const { html, error, redirected, resourceHints } = result\n\n      if (redirected) {\n        return html\n      }\n      if (error) {\n        res.statusCode = context.nuxt.error.statusCode || 500\n      }\n\n      // Add ETag header\n      if (!error && this.options.render.etag) {\n        const etag = generateETag(html, this.options.render.etag)\n        if (fresh(req.headers, { etag })) {\n          res.statusCode = 304\n          res.end()\n          return\n        }\n        res.setHeader('ETag', etag)\n      }\n\n      // HTTP2 push headers\n      if (!error && this.options.render.http2.push) {\n        // Parse resourceHints to extract HTTP.2 prefetch/push headers\n        // https://w3c.github.io/preload/#server-push-http-2\n        const regex = /link rel=\"([^\"]*)\" href=\"([^\"]*)\" as=\"([^\"]*)\"/g\n        const pushAssets = []\n        let m\n        while (m = regex.exec(resourceHints)) { // eslint-disable-line no-cond-assign\n          const [_, rel, href, as] = m // eslint-disable-line no-unused-vars\n          if (rel === 'preload') {\n            pushAssets.push(`<${href}>; rel=${rel}; as=${as}`)\n          }\n        }\n        // Pass with single Link header\n        // https://blog.cloudflare.com/http-2-server-push-with-multiple-assets-per-link-header\n        res.setHeader('Link', pushAssets.join(','))\n      }\n\n      // Send response\n      res.setHeader('Content-Type', 'text/html; charset=utf-8')\n      res.setHeader('Content-Length', Buffer.byteLength(html))\n      res.end(html, 'utf8')\n      return html\n    } catch (err) {\n      /* istanbul ignore if */\n      if (context && context.redirected) {\n        console.error(err) // eslint-disable-line no-console\n        return err\n      }\n\n      next(err)\n    }\n  }\n\n  errorMiddleware(err, req, res, next) {\n    // ensure statusCode, message and name fields\n    err.statusCode = err.statusCode || 500\n    err.message = err.message || 'Nuxt Server Error'\n    err.name = (!err.name || err.name === 'Error') ? 'NuxtServerError' : err.name\n\n    // We hide actual errors from end users, so show them on server logs\n    if (err.statusCode !== 404) {\n      console.error(err) // eslint-disable-line no-console\n    }\n\n    const sendResponse = (content, type = 'text/html') => {\n      // Set Headers\n      res.statusCode = err.statusCode\n      res.statusMessage = err.name\n      res.setHeader('Content-Type', type + '; charset=utf-8')\n      res.setHeader('Content-Length', Buffer.byteLength(content))\n\n      // Send Response\n      res.end(content, 'utf-8')\n    }\n\n    // Check if request accepts JSON\n    const hasReqHeader = (header, includes) => req.headers[header] && req.headers[header].toLowerCase().includes(includes)\n    const isJson = hasReqHeader('accept', 'application/json') || hasReqHeader('user-agent', 'curl/')\n\n    // Use basic errors when debug mode is disabled\n    if (!this.options.debug) {\n      // Json format is compatible with Youch json responses\n      const json = {\n        status: err.statusCode,\n        message: err.message,\n        name: err.name\n      }\n      if (isJson) {\n        sendResponse(JSON.stringify(json, undefined, 2), 'text/json')\n        return\n      }\n      const html = this.resources.errorTemplate(json)\n      sendResponse(html)\n      return\n    }\n\n    // Show stack trace\n    const youch = new Youch(err, req, this.readSource.bind(this))\n    if (isJson) {\n      youch.toJSON().then(json => { sendResponse(JSON.stringify(json, undefined, 2), 'text/json') })\n    } else {\n      youch.toHTML().then(html => { sendResponse(html) })\n    }\n  }\n\n  async readSource(frame) {\n    const serverBundle = this.resources.serverBundle\n\n    // Remove webpack:/// & query string from the end\n    const sanitizeName = name => name ? name.replace('webpack:///', '').split('?')[0] : ''\n\n    // SourceMap Support for SSR Bundle\n    if (serverBundle && serverBundle.maps[frame.fileName]) {\n      // Initialize smc cache\n      if (!serverBundle.$maps) {\n        serverBundle.$maps = {}\n      }\n\n      // Read SourceMap object\n      const smc = serverBundle.$maps[frame.fileName] || new SourceMapConsumer(serverBundle.maps[frame.fileName])\n      serverBundle.$maps[frame.fileName] = smc\n\n      // Try to find original position\n      const { line, column, name, source } = smc.originalPositionFor({\n        line: frame.getLineNumber() || 0,\n        column: frame.getColumnNumber() || 0,\n        bias: SourceMapConsumer.LEAST_UPPER_BOUND\n      })\n      if (line) {\n        frame.lineNumber = line\n      }\n      if (column) {\n        frame.columnNumber = column\n      }\n      if (name) {\n        frame.functionName = name\n      }\n      if (source) {\n        frame.fileName = sanitizeName(source)\n\n        // Source detected, try to get original source code\n        const contents = smc.sourceContentFor(source)\n        if (contents) {\n          frame.contents = contents\n        }\n      }\n    }\n\n    // Return if fileName is still unknown\n    if (!frame.fileName) {\n      return\n    }\n\n    frame.fileName = sanitizeName(frame.fileName)\n\n    // Try to read from SSR bundle files\n    if (serverBundle && serverBundle.files[frame.fileName]) {\n      frame.contents = serverBundle.files[frame.fileName]\n      return\n    }\n\n    // Possible paths for file\n    const searchPath = [\n      this.options.rootDir,\n      join(this.options.buildDir, 'dist'),\n      this.options.srcDir,\n      this.options.buildDir\n    ]\n\n    // Scan filesystem for real path\n    for (let pathDir of searchPath) {\n      let fullPath = resolve(pathDir, frame.fileName)\n      let source = await fs.readFile(fullPath, 'utf-8').catch(() => null)\n      if (source) {\n        if (!frame.contents) {\n          frame.contents = source\n        }\n        frame.fullPath = fullPath\n        return\n      }\n    }\n  }\n\n  async renderRoute(url, context = {}) {\n    /* istanbul ignore if */\n    if (!this.isReady) {\n      return new Promise(resolve => {\n        setTimeout(() => resolve(this.renderRoute(url, context)), 1000)\n      })\n    }\n\n    // Log rendered url\n    debug(`Rendering url ${url}`)\n\n    // Add url and isSever to the context\n    context.url = url\n\n    // Basic response if SSR is disabled or spa data provided\n    const spa = context.spa || (context.res && context.res.spa)\n    const ENV = this.options.env\n\n    if (this.noSSR || spa) {\n      const { HTML_ATTRS, BODY_ATTRS, HEAD, BODY_SCRIPTS, resourceHints } = await this.metaRenderer.render(context)\n      const APP = `<div id=\"__nuxt\">${this.resources.loadingHTML}</div>` + BODY_SCRIPTS\n\n      // Detect 404 errors\n      if (url.includes(this.options.build.publicPath) || url.includes('__webpack')) {\n        const err = { statusCode: 404, message: this.options.messages.error_404, name: 'ResourceNotFound' }\n        throw err\n      }\n\n      const html = this.resources.spaTemplate({\n        HTML_ATTRS,\n        BODY_ATTRS,\n        HEAD,\n        APP,\n        ENV\n      })\n\n      return { html, resourceHints }\n    }\n\n    // Call renderToString from the bundleRenderer and generate the HTML (will update the context as well)\n    let APP = await this.bundleRenderer.renderToString(context)\n\n    if (!context.nuxt.serverRendered) {\n      APP = '<div id=\"__nuxt\"></div>'\n    }\n    const m = context.meta.inject()\n    let HEAD = m.meta.text() + m.title.text() + m.link.text() + m.style.text() + m.script.text() + m.noscript.text()\n    if (this.options._routerBaseSpecified) {\n      HEAD += `<base href=\"${this.options.router.base}\">`\n    }\n\n    let resourceHints = ''\n\n    if (this.options.render.resourceHints) {\n      resourceHints = context.renderResourceHints()\n      HEAD += resourceHints\n    }\n    APP += `<script type=\"text/javascript\">window.__NUXT__=${serialize(context.nuxt, { isJSON: true })};</script>`\n    APP += context.renderScripts()\n    APP += m.script.text({ body: true })\n\n    HEAD += context.renderStyles()\n\n    let html = this.resources.ssrTemplate({\n      HTML_ATTRS: 'data-n-head-ssr ' + m.htmlAttrs.text(),\n      BODY_ATTRS: m.bodyAttrs.text(),\n      HEAD,\n      APP,\n      ENV\n    })\n\n    return {\n      html,\n      resourceHints,\n      error: context.nuxt.error,\n      redirected: context.redirected\n    }\n  }\n\n  async renderAndGetWindow(url, opts = {}) {\n    /* istanbul ignore if */\n    if (!jsdom) {\n      try {\n        jsdom = require('jsdom')\n      } catch (e) /* istanbul ignore next */ {\n        console.error('Fail when calling nuxt.renderAndGetWindow(url)') // eslint-disable-line no-console\n        console.error('jsdom module is not installed') // eslint-disable-line no-console\n        console.error('Please install jsdom with: npm install --save-dev jsdom') // eslint-disable-line no-console\n        throw e\n      }\n    }\n    let options = {\n      resources: 'usable', // load subresources (https://github.com/tmpvar/jsdom#loading-subresources)\n      runScripts: 'dangerously',\n      beforeParse(window) {\n        // Mock window.scrollTo\n        window.scrollTo = () => {}\n      }\n    }\n    if (opts.virtualConsole !== false) {\n      options.virtualConsole = new jsdom.VirtualConsole().sendTo(console)\n    }\n    url = url || 'http://localhost:3000'\n    const { window } = await jsdom.JSDOM.fromURL(url, options)\n    // If Nuxt could not be loaded (error from the server-side)\n    const nuxtExists = window.document.body.innerHTML.includes(this.options.render.ssr ? 'window.__NUXT__' : '<div id=\"__nuxt\">')\n    /* istanbul ignore if */\n    if (!nuxtExists) {\n      let error = new Error('Could not load the nuxt app')\n      error.body = window.document.body.innerHTML\n      throw error\n    }\n    // Used by nuxt.js to say when the components are loaded and the app ready\n    await new Promise((resolve) => {\n      window._onNuxtLoaded = () => resolve(window)\n    })\n    // Send back window object\n    return window\n  }\n}\n\nconst parseTemplate = templateStr => _.template(templateStr, {\n  interpolate: /{{([\\s\\S]+?)}}/g\n})\n\nconst resourceMap = [\n  {\n    key: 'clientManifest',\n    fileName: 'vue-ssr-client-manifest.json',\n    transform: JSON.parse\n  },\n  {\n    key: 'serverBundle',\n    fileName: 'server-bundle.json',\n    transform: JSON.parse\n  },\n  {\n    key: 'ssrTemplate',\n    fileName: 'index.ssr.html',\n    transform: parseTemplate\n  },\n  {\n    key: 'spaTemplate',\n    fileName: 'index.spa.html',\n    transform: parseTemplate\n  }\n]\n\n// Protector utility against request to SSR bundle files\nconst ssrResourceRegex = new RegExp(resourceMap.map(resource => resource.fileName).join('|'), 'i')\n","import chalk from 'chalk'\nimport { Options } from 'common'\nimport { sequence } from 'utils'\nimport ModuleContainer from './module'\nimport Renderer from './renderer'\nimport Debug from 'debug'\nimport enableDestroy from 'server-destroy'\nimport Module from 'module'\nimport { isPlainObject } from 'lodash'\nimport { join, resolve } from 'path'\n\nconst debug = Debug('nuxt:')\ndebug.color = 5\n\nexport default class Nuxt {\n  constructor(options = {}) {\n    this.options = Options.from(options)\n\n    // Paths for resolving requires from `rootDir`\n    this.nodeModulePaths = Module._nodeModulePaths(this.options.rootDir)\n\n    this.initialized = false\n    this.errorHandler = this.errorHandler.bind(this)\n    // Hooks\n    this._hooks = {}\n    this.hook = this.hook.bind(this)\n\n    // Create instance of core components\n    this.moduleContainer = new ModuleContainer(this)\n    this.renderer = new Renderer(this)\n\n    // Backward compatibility\n    this.render = this.renderer.app\n    this.renderRoute = this.renderer.renderRoute.bind(this.renderer)\n    this.renderAndGetWindow = this.renderer.renderAndGetWindow.bind(this.renderer)\n\n    this._ready = this.ready().catch(this.errorHandler)\n  }\n\n  async ready() {\n    if (this._ready) {\n      return this._ready\n    }\n\n    // Add hooks\n    if (isPlainObject(this.options.hooks)) {\n      this.addObjectHooks(this.options.hooks)\n    } else if (typeof this.options.hooks === 'function') {\n      this.options.hooks(this.hook)\n    }\n    // Add nuxt modules\n    await this.moduleContainer.ready()\n    await this.renderer.ready()\n\n    this.initialized = true\n    await this.callHook('ready', this)\n\n    return this\n  }\n\n  plugin(name, fn) {\n    // eslint-disable-next-line no-console\n    console.error(`[warn] nuxt.plugin('${name}',..) is deprecated. Please use new hooks system.`)\n\n    // A tiny backward compatibility util\n    const hookMap = {\n      'ready': 'ready',\n      'close': 'close',\n      'listen': 'listen',\n      'built': 'build:done'\n    }\n\n    if (hookMap[name]) {\n      this.hook(hookMap[name], fn)\n    }\n\n    // Always return nuxt class which has plugin() for two level hooks\n    return this\n  }\n\n  hook(name, fn) {\n    if (!name || typeof fn !== 'function') {\n      return\n    }\n    this._hooks[name] = this._hooks[name] || []\n    this._hooks[name].push(fn)\n  }\n\n  async callHook(name, ...args) {\n    if (!this._hooks[name]) {\n      return\n    }\n    debug(`Call ${name} hooks (${this._hooks[name].length})`)\n    try {\n      await sequence(this._hooks[name], (fn) => fn(...args))\n    } catch (err) {\n      console.error(`> Error on hook \"${name}\":`) // eslint-disable-line no-console\n      console.error(err) // eslint-disable-line no-console\n    }\n  }\n\n  addObjectHooks(hooksObj) {\n    Object.keys(hooksObj).forEach((name) => {\n      let hooks = hooksObj[name]\n      hooks = (Array.isArray(hooks) ? hooks : [hooks])\n\n      hooks.forEach((hook) => {\n        this.hook(name, hook)\n      })\n    })\n  }\n\n  listen(port = 3000, host = 'localhost') {\n    return new Promise((resolve, reject) => {\n      const server = this.renderer.app.listen({ port, host, exclusive: false }, (err) => {\n        /* istanbul ignore if */\n        if (err) {\n          return reject(err)\n        }\n\n        const _host = host === '0.0.0.0' ? 'localhost' : host\n        // eslint-disable-next-line no-console\n        console.log('\\n' + chalk.bgGreen.black(' OPEN ') + chalk.green(` http://${_host}:${port}\\n`))\n\n        // Close server on nuxt close\n        this.hook('close', () => new Promise((resolve, reject) => {\n          // Destroy server by forcing every connection to be closed\n          server.destroy(err => {\n            debug('server closed')\n            /* istanbul ignore if */\n            if (err) {\n              return reject(err)\n            }\n            resolve()\n          })\n        }))\n\n        this.callHook('listen', server, { port, host }).then(resolve)\n      })\n\n      // Add server.destroy(cb) method\n      enableDestroy(server)\n    })\n  }\n\n  errorHandler/* istanbul ignore next */() {\n    // Apply plugins\n    // eslint-disable-next-line no-console\n    this.callHook('error', ...arguments).catch(console.error)\n\n    // Silent\n    if (this.options.errorHandler === false) {\n      return\n    }\n\n    // Custom errorHandler\n    if (typeof this.options.errorHandler === 'function') {\n      return this.options.errorHandler.apply(this, arguments)\n    }\n\n    // Default handler\n    // eslint-disable-next-line no-console\n    console.error(...arguments)\n  }\n\n  resolvePath(path) {\n    // Try to resolve using NPM resolve path first\n    try {\n      let resolvedPath = Module._resolveFilename(path, { paths: this.nodeModulePaths })\n      return resolvedPath\n    } catch (e) {\n      // Just continue\n    }\n    // Shorthand to resolve from project dirs\n    if (path.indexOf('@@') === 0 || path.indexOf('~~') === 0) {\n      return join(this.options.rootDir, path.substr(2))\n    } else if (path.indexOf('@') === 0 || path.indexOf('~') === 0) {\n      return join(this.options.srcDir, path.substr(1))\n    }\n    return resolve(this.options.srcDir, path)\n  }\n\n  async close(callback) {\n    await this.callHook('close', this)\n\n    /* istanbul ignore if */\n    if (typeof callback === 'function') {\n      await callback()\n    }\n  }\n}\n"],"names":["encodeHtml","str","replace","getContext","req","res","setAnsiColors","ansiHTML","setColors","ms","Promise","resolve","waitFor","urlJoin","slice","call","arguments","join","isUrl","url","indexOf","promisifyRoute","fn","Array","isArray","length","reject","err","routeParams","promise","then","sequence","tasks","reduce","task","parallel","all","map","chainFn","base","Function","apply","baseResult","undefined","fnResult","prototype","isPureObject","o","isWindows","test","process","platform","wp","p","wChunk","reqSep","sysSep","_","escapeRegExp","sep","normalize","string","r","args","lastArg","last","includes","relativeTo","dir","shift","path","rp","relative","flatRoutes","router","routes","forEach","children","push","cleanChildrenRoutes","isChild","start","routesIndex","route","name","split","s","names","paths","i","a","find","child","createRoutes","files","srcDir","file","keys","component","parent","key","chunkName","sort","b","y","z","_a","_b","debug","Debug","color","Options","from","_options","options","Object","assign","loading","middleware","_routerBaseSpecified","transition","layoutTransition","defaultsDeep","defaults","hasValue","v","rootDir","cwd","modulesDir","buildDir","cacheDir","appTemplatePath","existsSync","dev","build","publicPath","store","loadingIndicator","cssSourceMap","postcss","postcssConfigPath","plugins","modePreset","modes","mode","render","ssr","appear","env","NODE_ENV","__dirname","ModuleContainer","nuxt","requiredModules","callHook","modules","addModule","bind","vendor","uniq","concat","template","src","srcPath","parse","fs","dst","fileName","basename","hash","ext","templateObj","templates","addTemplate","unshift","serverMiddleware","extend","extendRoutes","moduleOpts","requireOnce","module","require","resolvePath","Error","JSON","stringify","meta","alreadyRequired","result","MetaRenderer","renderer","vueRenderer","VueServerRenderer","createRenderer","cache","LRU","use","VueMeta","vm","Vue","h","head","renderToString","$meta","inject","get","m","getMeta","HTML_ATTRS","htmlAttrs","text","BODY_ATTRS","bodyAttrs","HEAD","title","link","style","script","noscript","BODY_SCRIPTS","body","resourceHints","clientManifest","resources","initial","async","set","jsdom","Renderer","bundleRenderer","metaRenderer","webpackDevMiddleware","webpackHotMiddleware","app","connect","parseTemplate","setupMiddleware","loadResources","_fs","distPath","updated","transform","rawKey","rawData","data","readFileSync","errorTemplatePath","errorTemplate","loadingHTMLPath","loadingHTML","noSSR","isReady","Boolean","spaTemplate","ssrTemplate","isResourcesAvailable","serverBundle","createBundleRenderer","$m","handler","prefix","$src","gzip","useMiddleware","compression","next","ssrResourceRegex","statusCode","end","_this","openInEditor","editor","configure","query","q","part","decodeURIComponent","log","open","catch","serveStatic","static","distDir","nuxtMiddleware","errorMiddleware","context","renderRoute","html","error","redirected","etag","generateETag","fresh","headers","setHeader","http2","regex","pushAssets","exec","rel","href","as","Buffer","byteLength","message","sendResponse","content","type","statusMessage","hasReqHeader","header","toLowerCase","isJson","json","youch","Youch","readSource","toJSON","toHTML","frame","sanitizeName","maps","$maps","smc","SourceMapConsumer","line","column","source","originalPositionFor","getLineNumber","getColumnNumber","LEAST_UPPER_BOUND","lineNumber","columnNumber","functionName","contents","sourceContentFor","searchPath","pathDir","fullPath","readFile","spa","ENV","APP","messages","error_404","serverRendered","renderResourceHints","serialize","isJSON","renderScripts","renderStyles","opts","e","window","scrollTo","virtualConsole","VirtualConsole","sendTo","console","JSDOM","fromURL","nuxtExists","document","innerHTML","_onNuxtLoaded","templateStr","resourceMap","RegExp","resource","Nuxt","nodeModulePaths","Module","_nodeModulePaths","initialized","errorHandler","_hooks","hook","moduleContainer","renderAndGetWindow","_ready","ready","isPlainObject","hooks","addObjectHooks","hookMap","hooksObj","port","host","server","listen","exclusive","_host","chalk","bgGreen","black","green","destroy","resolvedPath","_resolveFilename","substr","callback"],"mappings":"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"}